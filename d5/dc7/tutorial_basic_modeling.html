<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MARS: Basic Modeling</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../mars_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo_v2_wob.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MARS
   </div>
   <div id="projectbrief">An open-source, flexible 3D physical simulation framework</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/dc7/tutorial_basic_modeling.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Basic Modeling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>In this tutorial you will learn how to build a simple model of a robot in Blender and how to export it to MARS.</p>
<h2>Prerequisites</h2>
<p>We assume you already have a MARS development environment setup in "~/devel/". You should also have a recent version of Blender installed (we use 2.62 in this tutorial).</p>
<h2>Blender Basics</h2>
<p>Blender's shortcuts and hotkeys depend on the context in which they are triggered. The context is usually determined by the mouse cursor. That means that a certain hotkey, "alt+p" for example, will have different meanings depending on the position of the mouse. When the mouse is hovering the 3D-View the hotkey "alt+p" will break up child-parent relations, when hovering the text editor it will run the current script.</p>
<h3>3D-View Shortcuts and Hotkeys</h3>
<table class="doxtable">
<tr>
<th>Operation </th><th>Shortcut  </th></tr>
<tr>
<td>rotate view </td><td>middle mouse button </td></tr>
<tr>
<td>move view </td><td>shift + middle mouse button </td></tr>
<tr>
<td>zoom view </td><td>mouse wheel or ctrl + middle mouse button </td></tr>
<tr>
<td>move object (grab) </td><td>g </td></tr>
<tr>
<td>rotate object </td><td>r </td></tr>
<tr>
<td>scale object </td><td>s </td></tr>
<tr>
<td>restrict move/rotate/scale axis </td><td>Press x, y, or z while moving/rotating/scaling. If you press the same axis again it will select the local axis. Pressing a third time will deselect the axis. </td></tr>
<tr>
<td>open toolbar </td><td>n </td></tr>
<tr>
<td>select object </td><td>right click </td></tr>
<tr>
<td>select multiple objects </td><td>shift + right click or "b" and drag a selection box </td></tr>
<tr>
<td>set parent object </td><td>first select child, then the parent (shift + right click), then press "ctrl+p" </td></tr>
</table>
<h3>Rescaling Objects</h3>
<p>If you edit the dimensions of an object in "object mode" you might notice that the scale changes automatically. This is because in object mode you do not really change the object's vertices. To apply the changes you did in "object mode" to the object's vertices you can press "ctrl+a" (with the mouse hovering over the 3D-View) and choose scale. You will notice that the scale in "object mode" is back to (1, 1, 1). Alternatively you can select this option from the menu object-&gt;apply-&gt;scale</p>
<div class="image">
<img src="../../object_menu.png" alt="object_menu.png"/>
<div class="caption">
Object Menu</div></div>
 <h2>Building the Model</h2>
<ol type="1">
<li>Start by creating a box of the dimensions 0.5 x 0.3 x 0.2 this can be done by directly editing the object properties "Dimensions" in the toolbar.</li>
<li><p class="startli">Rename the object (e.g. "Body") this can be done in the object property window.</p>
<div class="image">
<img src="../../rename_object2.png" alt="rename_object2.png"/>
<div class="caption">
Renaming an object</div></div>
</li>
<li><p class="startli">Choose a color by selecting a diffuse and/or specular color in the material property window.</p>
<div class="image">
<img src="../../material.png" alt="material.png"/>
<div class="caption">
Material properties</div></div>
</li>
<li>It is convenient to have the model on a different layer than the camera and lights. Therefore we move it to a different layer by selecting everything belonging to the model (so far only the box). Then press "m" and select a new layer to move the objects to that layer.</li>
<li><p class="startli">Create a sphere that will serve as a wheel. In the Menu select "Add-&gt;Mesh-&gt;UV Sphere" and name the object (e.g., "Wheel.000").</p>
<div class="image">
<img src="../../create_sphere2.png" alt="create_sphere2.png"/>
<div class="caption">
Create Sphere</div></div>
</li>
<li>Scale the sphere to an appropriate size (we used 0.1 in all dimensions)</li>
<li>Position the sphere at a lower corner of the box be setting its location parameters (e.g., x=0.25; y=-0.15; z=-0.1)</li>
<li><p class="startli">Create a new material by pressing "new" in the material property window</p>
<div class="image">
<img src="../../new_material.png" alt="new_material.png"/>
<div class="caption">
New Material</div></div>
</li>
<li>Set material properties for the wheel/sphere.</li>
<li>Set up parent-child relationship between the body and the wheel. Select the child and the parent (in that order) and press "ctrl+p". NOTE: If you want to break up a parent-child relationship you should select the child object in the 3D-View and press "alt+p" (while hovering the 3D-View) and select "Clear and
    Keep Transformation".</li>
<li><p class="startli">The way we currently export joints from blender to MARS is via helper objects that contain all relevant information (e.g., joint and motor type, limits, etc.) in custom properties. So go ahead and create a arbitrary object (we usually use slim cylinders because you can clearly see the rotation axis) and position it at the location of the joint. It helps if the child object of the joint has the same origin and orientation as the joint helper object. Create two custom properties in the "object property" window.</p>
<div class="image">
<img src="../../joint.png" alt="joint.png"/>
<div class="caption">
Joint</div></div>
<p> For the first custom property press edit to set the "property
    name" to "type" and the "property value" to "joint" for the second custom property press edit to set the "property name" to "node2" and the "property value" to "Wheel.000" this tells the export script that this is a helper object for a "joint" and that the object on the output shaft is the "Wheel.000" object. The object on the input shaft it determined by the parent of the helper object itself so set that to "Body".</p>
</li>
<li>By default each joint is automatically associated with a servo motor. To change the motor type to a PID motor you need to create another custom property called "motor_type" and set its value to "2" (note that you might need to increase the "Max" value in the custom property)</li>
<li><p class="startli">Turn the timeline into a text editor</p>
<div class="image">
<img src="../../text_editor.png" alt="text_editor.png"/>
<div class="caption">
Text Editor</div></div>
</li>
<li>By selecting the menu "text-&gt;Open Text Block" in the text editor open the "create_mars_props.py" script from ~/devel/mars/scripts/blender/</li>
<li>Select all objects of the model in the 3d-view and run the script by pressing "Run Script" in the text editor window. You will see that this creates various custom properties on every object. You are free to edit these properties (e.g. set the mass)</li>
<li>For the wheel create two more custom properties: "physicMode" and "radius". Set "physicMode" to "sphere" and "radius" to half the diameter (in our case 0.05). Otherwise the physical representation of the wheels in the simulation would be boxes makeing very poor wheels.</li>
<li>Duplicate the wheel and the helper object by selecting them and pressing "shift+d". A duplicated object will inherit the location, orientation, material, parent, and custom properties among other things. By nameing the first wheel "Wheel.000" we ensure consistent nameing. Blender automatically increases the ending to "Wheel.001" for the duplication. Of course you can set the name to what ever you like.</li>
<li>Also create the last two remaining wheels by duplicating one of the first. Position the four wheels at the four lower corners of the box.</li>
<li>Do not forget to change the value of the "node2" in each of the copied helper objects' custom property.</li>
<li><p class="startli">Add the custom properties "filename" and "path" to the World and fill in where you want to export the scene to. Ideally, this should be an empty directory because bside the .scn file the .obj and .scene files are also exported for debuging purposes.</p>
<div class="image">
<img src="../../world_properties.png" alt="world_properties.png"/>
<div class="caption">
World Properties</div></div>
</li>
<li>Load the "relative_mars_export.py" from ~/devel/mars/scripts/blender/ in the text editor window.</li>
<li>Select all objects of the model and run the relative_mars_export script.</li>
<li>Do not forget to save your blender scene.</li>
</ol>
<p>Congratulations! You have your first blender created MARS scene. If the scene is not correctly displayed in MARS (e.g. dimensions of the objects appear differently), you might have to change the scale of your meshes in Blender. For this, select all of them, then go to the Object menu and click "Apply-&gt;Scale". The same goes for rotation in case there are errors. Also in the Object menu, you can select "Transform-&gt;Origin to Geometry", which will fix similar problems with the meshes' positions.</p>
<p>However, if you load the scene in MARS and try to do a tank turn you might notice that it does not work to well. You would need to tune the friction parameters for the wheels. Alternatively, we add a third pair of wheels to the model to show the workflow of editing an existing scene.</p>
<ol type="1">
<li>Reopen your blender scene if you do not have it opened any more.</li>
<li><p class="startli">Duplicate a wheel pair (shift+d after selecting the parts) and move it to the middle of the body ("g" for grab; "x" to constrain the movement to the x-axis; "0.25" to move it to the middle)</p>
<div class="image">
<img src="../../new_wheels.png" alt="new_wheels.png"/>
<div class="caption">
New Wheels</div></div>
</li>
<li>Adjust the custom property "node2" of the new joint helper objects to let them point to the new wheels.</li>
<li>Re-run the "create_mars_props.py" script. You need to execute this script everytime you add or remove an object to/from the scene because it will assign unique ids to all objects and group objects belonging together.</li>
<li>Run the "relative_mars_export.py" script to update the scene.</li>
<li>Test in MARS! </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 2 2015 17:29:44 for MARS by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
