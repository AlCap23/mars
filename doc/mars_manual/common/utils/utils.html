<!-- DO NOT EDIT THIS FILE! IT IS AUTOMATICALLY GENERATED BY markdown2marshtml //-->
             <!DOCTYPE html>
             <html>
               <head>
                 <title>MARS Simulator</title>
                 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
                 <meta name="description" content="MARS is a flexible physics simulator.">
                 <meta name="author" content="MARS Project">
                 <meta name="keywords" content="MARS, simulation, physics, robotics">
                 <link rel="stylesheet" type="text/css" href="../../../src/css/mars_default.css" media="all" />
               </head>
             <body>
               <div class="nav-box">
                 <h2>Navigation</h2>
                 <nav>
                   <ol>
                     <li><a href="../../../mars_manual/index.html">Home</a></li>
                     <li>Common</li>
<ul>
  <li><a href="../../../mars_manual/common/utils/utils.html">Utils</a></li>
<ul>
  <li><a href=#overview>Overview</a></li>
<li><a href=#threads-and-mutex-functionality>Threads And Mutex Functionality</a></li>
<ul>
  <li><a href=#configmap>Configmap</a></li>
</ul>
</ul>
    <li><a href="../../../mars_manual/common/data_broker/data_broker.html">Data Broker</a></li>
    <li><a href="../../../mars_manual/common/lib_manager/lib_manager.html">Lib Manager</a></li>
</ul>
    <li><a href="../../../mars_manual/libraries.html">Libraries</a></li>
<li><a href="../../../mars_manual/inner_workings.html">Inner Workings</a></li>
<li><a href="../../../mars_manual/mars_scenes.html">Mars Scenes</a></li>
<li><a href="../../../mars_manual/documentation_structure.html">Documentation Structure</a></li>
<li><a href="../../../mars_manual/installation.html">Installation</a></li>
<li>Tutorials</li>
<ul>
  <li><a href="../../../mars_manual/tutorials/plugins.html">Plugins</a></li>
  <li><a href="../../../mars_manual/tutorials/building_mars.html">Building Mars</a></li>
  <li><a href="../../../mars_manual/tutorials/advanced_modeling.html">Advanced Modeling</a></li>
  <li><a href="../../../mars_manual/tutorials/basic_modeling.html">Basic Modeling</a></li>
  <li>Plugins</li>
  <ul>
    <li><a href="../../../mars_manual/plugins/obstacle_generator/obstacle_generator.html">Obstacle Generator</a></li>
</ul>
</ul>

                   </ol>
                 </nav>
               </div>
               <div id="content">
               <header>
                 <a href="../../../mars_manual/index.html"><img src="../../../src/images/logo_v2_wob.png" alt="MARS" /></a>
               </header>
<h1 id="mars_utils">MARS Utils</h1>
<h2 id="overview">Overview</h2>
<p>The mars_utils library provides some helpful general c++ functionality. It contains a system independet thread and mutex implementation with a similar api like the Qt4 libraries. Some static math and system functions are defined in the misc.h and mathUtils.h. The ConfigData.h includes the ConfigMap wich is a nested std::map/std::vector implementation to store configuration information in a similar way like a python dictionary.</p>
<h2 id="threads-and-mutex-functionality">Threads and Mutex functionality</h2>
<p>To use the thread implementation (a wrapping of pthread) just inherit from mars::utils::Thread and implement the protected run() method. To start the thread just call the start() methon on your instance (see <i>Thread</i> for more details). Thread example:</p>
<pre><code>#include &lt;mars/utils/Thread.h&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;sstream&gt;

class MyThread : public mars::utils::Thread {

public:
  MyThread() : done(false) {}

  void stop() {
    done=true;
  }

protected:
  void run() {
    while(!done) {
      fprintf(stderr, &quot;.&quot;);
      msleep(10);
    }
  }

private:
  bool done;
};

int main(int argc, char *argv[]) {
  std::string input;

  MyThread *myThread = new MyThread();
  myThread-&gt;start();

  while(input.size() &lt; 1 || input[0] != &#39;q&#39;) {
    getline(std::cin, input);
  }      
  myThread-&gt;stop();
  myThread-&gt;wait();
  printf(&quot;\n&quot;);

  return 0;
}</code></pre>
<p>To use a mutex simply create an instance of mars::utils::Mutex and use the lock() and unlock() method of the mutex. The mars::mutex::MutexLocker class gets a pointer to a mutex in the contructor and locks it there. In the destructor the mutex is unlocked. In this way the MutexLocker can be created as member variable at the begining of a method to lock the method call. While returning from the method call the MutexLocker is deleted and thus the mutex is unlocked.</p>
<h3 id="configmap">ConfigMap</h3>
<p>The ConfigMap is a nested implementation of std::maps and std::vectors to provide a python dictanary like data storage. Datatypes that can be stored are:</p>
<ul>
<li>std::string</li>
<li>int</li>
<li>unsigned int</li>
<li>unsinged long</li>
<li>double</li>
<li>bool</li>
</ul>
<p>An important feature is the loading and storing of ConfigMaps in yaml files. The example shows the usage of ConfigMaps for further details check <i>ConfigMap</i>.</p>
<p>Notice: While reading and writing yaml files the order of dictanaries is not necessarily kept.</p>
<p>Yaml example file:</p>
<pre><code>list: [1, 2, a, b]
name: foo
value1: 1.3
value2: 1
foo:
    foo2: Hello world!
    foo3: blub</code></pre>
<p>Example program:</p>
<pre><code>#include &lt;mars/utils/ConfigData.h&gt;

int main(int argc, char *argv[]) {

  // some ConfigMap test
  mars::utils::ConfigMap map;
  map = mars::utils::ConfigMap::fromYamlFile(&quot;test.yml&quot;);
  mars::utils::ConfigVector::iterator it;
  for(it=map[&quot;list&quot;].begin(); it!=map[&quot;list&quot;].end(); ++it) {
    printf(&quot;list entry: %s\n&quot;, it-&gt;getString().c_str());
  }
  double value1 = map[&quot;value1&quot;];
  printf(&quot;value1: %g\n&quot;, value1);
  int value2 =  map[&quot;value2&quot;];
  printf(&quot;value2: %d\n&quot;, value2);
  map[&quot;value2&quot;] = 3;
  printf(&quot;value2 modified: %d\n&quot;, value2);

  std::string foo2 = map[&quot;foo&quot;][&quot;foo2&quot;];
  std::string foo3 = map[&quot;foo&quot;][0][&quot;foo3&quot;];

  printf(&quot;%s\n&quot;, foo2.c_str());
  printf(&quot;%s\n&quot;, foo3.c_str());

  // add some keys:
  map[&quot;value3&quot;] = 3.14;
  printf(&quot;value3: %g\n&quot;, (double)map[&quot;value3&quot;]);

  map[&quot;blub&quot;][&quot;foo&quot;] = &quot;3.14&quot;;
  printf(&quot;blub/foo: %g\n&quot;, (double)map[&quot;blub&quot;][&quot;foo&quot;]);

  map.toYamlFile(&quot;result.yml&quot;);

  return 0;
}</code></pre>
<p>result.yml:</p>
<pre><code>foo:
  foo2: Hello world!
  foo3: blub
list:
  - 1
  - 2
  - a
  - b
name: foo
value1: 1.3
value2: 3
value3: 3.14
blub:
  foo: 3.14</code></pre>
<p>[26.08.2014]</p>

      <footer>
        <a href="http://validator.w3.org/check?uri=referer" target="_blank">
          <img src="http://www.w3.org/Icons/valid-html401"
               alt="Valid HTML 4.01 Transitional"/>
        </a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
          <img src="http://jigsaw.w3.org/css-validator/images/vcss"
               alt="Valid CSS!"/>
        </a>
      </footer>
    </div>
  </body>
</html>
