<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Advanced Modeling</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../mars_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo_triple.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">An open-source, flexible 3D physical simulation framework</div>
    </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/df4/tutorial_advanced_modeling.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Advanced Modeling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p>NOTE: This tutorial refers to creating the deprecated MARS Scene format. MARS will remain backwards compatible to MARS scenes as long as reasonably possible, but the SMURF format primarily supported in future development is SMURF (refer to Supported 3D Formats).</p>
<p>To use Blender for the creation of SMURF, check out the Blender Add-On <a href="http://www.github.com/rock-simulation/phobos">Phobos</a>.</p>
<p></p>
</blockquote>
<div class="image">
<img src="../../robot.png" alt="robot.png"/>
</div>
<h2>Introduction</h2>
<p>In this tutorial you will learn how to build model of a robot in Blender which has a more complicated structure than the car used in the basic modeling tutorial.</p>
<h2>Prerequisites</h2>
<p>You should have a recent version of Blender installed (we use 2.62 in this tutorial) and access to the scripts in your MARS development folder.</p>
<h2>Hierarchy and Object Types</h2>
<p>In MARS, models are hierarchically structured to attach different parts of the model to one another via joints. A very flat hierarchy was used in the basic modeling example, where the body of the modeled car was <em>parent</em> to each of the four wheels. This same principle applies, but with more levels, when more complicated models are created in MARS.</p>
<p>In general, objects in MARS can be either <em>bodies</em> or <em>joints</em>. A <em>body</em> is any object in the simulated world and can be either solid (and thus collide with other objects) or merely visible. A <em>joint</em> is not a physical object (nor normally visible), but a helper object defining how to connect bodies. This means that in order for bodies to have a constraint movement with respect to each other (other than collision), joints have to specify those contraints. If bodies are supposed to be fully constrained, they are combined in <em>groups</em>, which are derived from the parent and child relationships of the objects.</p>
<h2>Modeling a walking robot</h2>
<p>Let's implement all these elements in a model with a slighty more complex hierarchy. To keep things simple, we will only use <em>hinge</em> joints represented by cylinders as in the basic modeling tutorial and model the rather clumsy looking fellow shown above. You can of course choose another design of your own fancy as long as the overall morphology stays the same.</p>
<p>As a starting point, we model a main body (we chose a flat cylinder) and attach limbs to it that each possess two segments. Remember to use the <em>Add -&gt; Mesh</em> menu in Blender. Via joints, we connect the main body with the upper segment and the upper segment with the lower one:</p>
<div class="image">
<img src="../../building_arm.png" alt="building_arm.png"/>
</div>
<p>MARS does not take into account how far apart objects connected by joints are, thus to properly visually represent a joint, it is often helpful to add another object to "hide" that the objects are seemingly connected only by air. In our robot, we chose spheres for that purpose.</p>
<p>What is important now is to get the hierarchy in this system right. Since the lower leg is connected to the upper one, it has to be moved as well when the upper leg rotates around its joint to the main body. This can by setting the upper leg the <em>parent</em> of the lower leg, and the main body the <em>parent</em> of the upper leg. This effectively creates a hierarchy as shown here:</p>
<div class="image">
<img src="../../hierarchy.png" alt="hierarchy.png"/>
</div>
<p>Create the custom properties for the joints:</p>
<ul>
<li>motor_type: 1 (1 simulates a servo motor, 2 a simple electric motor)</li>
<li>type: joint</li>
<li>node2: here it's easiest to choose the spheres we used to represent the joints with visually</li>
</ul>
<p>Also, you can add a nice ball-shaped feet that will make collision-detection more accurate later on and set the custom properties <em>physicMode</em> to <em>sphere</em> as well as <em>radius</em> to the correct value like you did in the basic modeling tutorial. You can then run the <em>create_mars_props.py</em> script.</p>
<p>Now duplicate the leg (<em>Shift + D</em>) and rearrange the copies nicely around your body:</p>
<div class="image">
<img src="../../overview.png" alt="overview.png"/>
</div>
<p>Don't forget to again change the <em>node2</em> custom properties of the joints after duplicating the legs. If everything worked according to plan, you should have a hierarchy of objects in Blender looking somewhat like this, with the joint helper objects named "H.*":</p>
<div class="image">
<img src="../../blender_model_structure.png" alt="blender_model_structure.png"/>
</div>
<h2>Collision</h2>
<p>At this point you might be wondering: "Wait a second, all these solid bodies we created are penetrating each other, is this not going to be a problem for collision in MARS?" In fact, this is not a problem, as objects grouped together cannot collide and may therefore safely overlap. Neither do objets connected via joints show collision behaviour. However, this is only true for direct connections, but not true over more than one hierarchical level. Thus the main body and the upper leg of our robot cannot collide, but the main body and the lower leg do collide. This is the reason why it's important to give the objects helping to visually represent the joint the same parent as the joint itself (and the leg to which the joint is attached).</p>
<h2>Final Remarks</h2>
<p>And that's it, you've successfully built a walking robot. We'll deal with how to actually make it walk in another tutorial, but you can use MARS' motor controller window to manually play around with the robot and check whether everything worked out or not.</p>
<p>If you have taken a closer look at the custom properties created by the <em>create_mars_props</em> script you will have noticed that the hierarchy shown in the Blender model was mirrored in the groups: each section of the robot belonged to a separate group. Technically, the hierarchy introduced above is not strict in the sense that it is internally represented as connected groups rather than hierarchical levels. However, the <em>create_mars_props</em> script uses the hierarchy to properly subdivide everything in groups, thus if you have a centipede-like robot where each part is equally structurally equivalent, you will still have to order them manually into a nested hierarchy. The only alternative is to assign the group numbers manually before running the export script. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Oct 13 2016 15:08:32 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
